import fs from 'fs';
import path from 'path';

console.log({ CWD: path.join(process.cwd(), './src/assets/icons') });
const iconsDir = path.join(process.cwd(), './src/assets/icons');
const outputFile = path.join(process.cwd(), './src/icon-mapping.ts');

const icons = fs.readdirSync(iconsDir).filter((file) => file.endsWith('.svg'));

const mapping = icons.reduce((acc, file) => {
  const name = file.replace('.svg', '');
  // Consider using a relative path or ensuring your build system resolves @
  acc[name] = `@/assets/icons/${file}`;
  return acc;
}, {});

const fileContent = `
// @ts-nocheck
/**
 * AUTO-GENERATED FILE
 * This file is generated by the generate-icon-mapping.js script.
 */

import React from 'react';

export const iconMapping = {
  ${Object.entries(mapping)
    .map(
      ([key, value]) =>
        `"${key}": React.lazy(() => import(/* webpackChunkName: "Icon-${key}" */ "${value}")),`,
    )
    .join('\n  ')}
};
`;

fs.writeFileSync(outputFile, fileContent);

console.log(`Icon mapping generated: ${outputFile}`);
